<ui:composition xmlns="http://www.w3.org/1999/xhtml"
	xmlns:h="http://java.sun.com/jsf/html"
	xmlns:f="http://java.sun.com/jsf/core"
	xmlns:ui="http://java.sun.com/jsf/facelets"
	xmlns:p="http://primefaces.org/ui" template="/WEB-INF/template.xhtml">

	<ui:define name="title">Alta Constancia de Servicio</ui:define>

	<ui:define name="content">
		<h:form id="form">
			<p:breadCrumb>
				<p:menuitem value="Home" outcome="/dashboard" />
				<p:menuitem value="Inventarios" />
				<p:menuitem value="Servicios" />
				<p:menuitem value="Consultar"
					outcome="/inventarios/constanciaServicios" />
			</p:breadCrumb>
			<p:growl id="messages" showDetail="true" />
			<p:toolbar>
				<p:toolbarGroup>
						<p:selectOneMenu id="cliente-som" autoWidth="true" value="#{altaConstanciaServicioBean.idCliente}" filter="true" filterMatchMode="startsWith">
							<f:selectItem itemLabel="Selecione Cliente" itemValue="" noSelectionOption="true" />
							<f:selectItems var="cte"
								value="#{altaConstanciaServicioBean.clientes}"
								itemLabel="#{cte.cteNombre}"
								itemValue="#{cte.cteCve}" />
							<p:ajax listener="#{altaConstanciaServicioBean.filtrarCliente}" process="@this" update=":form:selProducto :form:selServicio"/>
						</p:selectOneMenu>
				</p:toolbarGroup>
				<p:toolbarGroup>
						<p:inputText id="txtFolio" value="#{altaConstanciaServicioBean.folio}" placeholder="Folio" />
				</p:toolbarGroup>
				<p:toolbarGroup>
						<p:datePicker id="fecha" showIcon="true"
							styleClass="p-mr-4 p-mb-2" placeholder="Fecha" disabled="true"
							value="#{altaConstanciaServicioBean.fecha}" />
				</p:toolbarGroup>
			</p:toolbar>
			<p:toolbar>
				<p:toolbarGroup>
					<p:inputNumber id="txtCantidadProd" value="#{altaConstanciaServicioBean.cantidad}" placeholder="Cantidad" minValue="1" decimalPlaces="0"/>
					<p:selectOneMenu id="selUnidad" autoWidth="true" filter="true"
						value="#{altaConstanciaServicioBean.idUnidadManejo}"
						filterMatchMode="startsWith">
						<f:selectItem itemLabel="Seleccione Unidad" itemValue="" noSelectionOption="true" />
						<f:selectItems var="selectedUnidadManejo"
							value="#{altaConstanciaServicioBean.alUnidades}"
							itemLabel="#{selectedUnidadManejo.unidadDeManejoDs}"
							itemValue="#{selectedUnidadManejo.unidadDeManejoCve}" />
					</p:selectOneMenu>
				</p:toolbarGroup>
				<p:toolbarGroup>
					<p:inputNumber id="txtPesoProd" value="#{altaConstanciaServicioBean.peso}" placeholder="Peso (kg)" minValue="0" decimalPlaces="3" />
					<p:selectOneMenu id="selProducto" autoWidth="true" filter="true"
						value="#{altaConstanciaServicioBean.idProducto}" filterMatchMode="startsWith">
						<f:selectItem itemLabel="Seleccione Producto" itemValue="" noSelectionOption="true" />
						<f:selectItems var="producto"
							value="#{altaConstanciaServicioBean.alProductosFiltered}"
							itemLabel="#{producto.productoCve.productoDs}"
							itemValue="#{producto.productoCve.productoCve}" />
					</p:selectOneMenu>
				</p:toolbarGroup>
				<p:toolbarGroup>
					<p:commandButton value="Agregar" icon="pi pi-plus"
						styleClass="ui-button-info p-mr-2 p-mb-2"
						actionListener="#{altaConstanciaServicioBean.agregarProducto}"
						update="dt-partidas"
						/>
				</p:toolbarGroup>
			</p:toolbar>
			<p:dataTable id="dt-partidas"
				var="partida"
				selection="#{altaConstanciaServicioBean.selPartida}"
				value="#{altaConstanciaServicioBean.alPartidas}"
				scrollable="true"
				scrollHeight="9em"
				scrollRows="3"
				reflow="true">
				<p:column headerText="Son" width="8em">
					<h:outputText value="#{partida.cantidadTotal}"/>
				</p:column>
				<p:column headerText="Unidad" width="10em">
					<h:outputText value="#{partida.unidadDeManejoCve.unidadDeManejoDs}" />
				</p:column>
				<p:column headerText="Producto">
					<h:outputText value="#{partida.productoCve.productoDs}"/>
				</p:column>
				<p:column headerText="Peso" width="8em">
					<h:outputText value="#{partida.cantidadDeCobro} kg"/>
				</p:column>
				<p:column width="8em">
					<p:commandButton icon="pi pi-times"
						styleClass="ui-button-info p-mr-2 p-mb-2"
						actionListener="#{altaConstanciaServicioBean.deletePartida(partida)}"
						update="dt-partidas"/>
				</p:column>
			</p:dataTable>
			<p:toolbar>
				<p:toolbarGroup>
					
					<p:selectOneMenu id="selServicio" autoWidth="true" filter="true"
						value="#{altaConstanciaServicioBean.idPrecioServicio}"
						filterMatchMode="startsWith">
						<f:selectItem itemLabel="Seleccione Servicio" itemValue="" noSelectionOption="true" />
						<f:selectItems var="selectedPrecioServicio"
							value="#{altaConstanciaServicioBean.alServicios}"
							itemLabel="#{selectedPrecioServicio.servicio.servicioDs} (#{selectedPrecioServicio.unidad.unidadDeManejoDs})"
							itemValue="#{selectedPrecioServicio.id}" />
					</p:selectOneMenu>
					<p:inputNumber id="txtCantidadSrv" value="#{altaConstanciaServicioBean.cantidadServicio}" placeholder="Cantidad" minValue="1" decimalPlaces="0" style="width: 6em;"/>
				</p:toolbarGroup>
				<p:toolbarGroup>
					
						<p:commandButton value="Agregar" icon="pi pi-plus"
							styleClass="ui-button-info p-mr-2 p-mb-2"
							actionListener="#{altaConstanciaServicioBean.agregarServicio}"
							update="dt-servicios"
							/>
					
				</p:toolbarGroup>
			</p:toolbar>
			<p:dataTable id="dt-servicios"
				var="servicio"
				selection="#{altaConstanciaServicioBean.selServicio}"
				value="#{altaConstanciaServicioBean.alServiciosDetalle}"
				scrollable="true"
				scrollHeight="9em"
				scrollRows="3"
				reflow="true">
				<p:column headerText="Servicio">
					<h:outputText value="#{servicio.servicioCve.servicioDs}" />
				</p:column>
				<p:column headerText="Cantidad" width="8em">
					<h:outputText value="#{servicio.servicioCantidad}" />
				</p:column>
				<p:column width="8em">
					<p:commandButton icon="pi pi-times"
						styleClass="ui-button-info p-mr-2 p-mb-2"
						actionListener="#{altaConstanciaServicioBean.deleteServicio(servicio)}"
						update="dt-servicios"/>
				</p:column>
			</p:dataTable>
			<p:toolbar>
				<p:toolbarGroup>
					<p:inputNumber id="txtValorDeclarado" value="#{altaConstanciaServicioBean.valorDeclarado}" placeholder="Valor declarado" minValue="1" decimalPlaces="2"/>
					<p:inputText id="txtNombreTransportista" value="#{altaConstanciaServicioBean.nombreTransportista}" placeholder="Nombre del transportista." />
					<p:inputText id="txtPlacasVehiculo" value="#{altaConstanciaServicioBean.placasVehiculo}" placeholder="Placas del transporte." />
					<p:inputText id="txtObservaciones" value="#{altaConstanciaServicioBean.observaciones}" placeholder="Indique aquÃ­ sus observaciones." style="width: 30em;"/>
				</p:toolbarGroup>
			</p:toolbar>
			<p:toolbar>
				<p:toolbarGroup>
					<p:commandButton value="Guardar" icon="pi pi-save"
						actionListener="#{altaConstanciaServicioBean.guardar}"/>
				</p:toolbarGroup>
			</p:toolbar>
		</h:form>
	</ui:define>
</ui:composition>
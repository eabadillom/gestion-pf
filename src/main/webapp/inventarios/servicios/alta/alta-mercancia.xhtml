<ui:composition xmlns="http://www.w3.org/1999/xhtml"
    xmlns:h="http://xmlns.jcp.org/jsf/html"
    xmlns:f="http://java.sun.com/jsf/core"
    xmlns:p="http://primefaces.org/ui"
    xmlns:ui="http://xmlns.jcp.org/jsf/facelets">
    <p:fieldset legend="MercancÃ­a" >
        <p:panel>
            <p:inputNumber id="txtCantidadProd" value="#{altaConstanciaServicioBean.partida.cantidadTotal}" placeholder="Cantidad" minValue="1" decimalPlaces="0">
                <p:ajax process="@this" />
            </p:inputNumber>
            <p:spacer width="5rem" />
            <p:selectOneMenu id="selUnidad" autoWidth="true" value="#{altaConstanciaServicioBean.partida.unidadDeCobro}" filter="true" filterMatchMode="contains" converter="entityConverter"
                             onchange="PF('statusInfoDialog').show();" >
                <f:selectItem itemLabel="Seleccione Unidad" itemValue="" noSelectionOption="true" />
                <f:selectItems var="unidad" value="#{altaConstanciaServicioBean.alUnidades}" itemLabel="#{unidad.unidadDeManejoDs}" itemValue="#{unidad}" />
                <p:ajax process="@this" oncomplete="PF('statusInfoDialog').hide();" />
            </p:selectOneMenu>
            <p:spacer width="5rem" />
            <p:inputNumber id="txtPesoProd" value="#{altaConstanciaServicioBean.partida.cantidadDeCobro}" placeholder="Peso (kg)" minValue="0" decimalPlaces="3">
                <p:ajax process="@this" />
            </p:inputNumber>
            <p:spacer width="5rem" />
            <p:selectOneMenu id="selProducto" autoWidth="true" value="#{altaConstanciaServicioBean.partida.productoCve}" filter="true" filterMatchMode="contains" converter="entityConverter"
                             onchange="PF('statusInfoDialog').show();" >
                <f:selectItem itemLabel="Seleccione Producto" noSelectionOption="true" />
                <f:selectItems var="producto" value="#{altaConstanciaServicioBean.alProductosFiltered}" itemLabel="#{producto.productoCve.productoDs}" itemValue="#{producto.productoCve}" />
                <p:ajax process="@this" oncomplete="PF('statusInfoDialog').hide();" />
            </p:selectOneMenu>
            <p:spacer width="5rem" />
            <p:commandButton value="Agregar" icon="pi pi-plus" styleClass="ui-button-info p-mr-2 p-mb-2" actionListener="#{altaConstanciaServicioBean.agregarProducto}" update="dt-partidas" onstart="PF('statusInfoDialog').show()" oncomplete="PF('statusInfoDialog').hide()" />
        </p:panel>
        <p:dataTable id="dt-partidas" var="partida" selection="#{altaConstanciaServicioBean.selPartida}" value="#{altaConstanciaServicioBean.alPartidas}" reflow="true">
            <p:column width="6rem" style="text-align: right;" headerText="Cantidad"><h:outputText value="#{partida.cantidadTotal}"/></p:column>
            <p:column width="8rem" style="text-align: center;" headerText="Unidad(es)"><h:outputText value="#{partida.unidadDeManejoCve.unidadDeManejoDs}" /></p:column>
            <p:column style="text-align: left;" headerText="Producto(s)"><h:outputText value="#{partida.productoCve.productoDs}"/></p:column>
            <p:column width="8rem" style="text-align: right;" headerText="Peso"><h:outputText value="#{partida.cantidadDeCobro} kg"/></p:column>
            <p:column width="2rem">
                <p:commandButton icon="pi pi-times" styleClass="ui-button-danger p-mr-2 p-mb-2" actionListener="#{altaConstanciaServicioBean.deletePartida(partida)}" update="dt-partidas" 
                                 onstart="PF('statusInfoDialog').show()" oncomplete="PF('statusInfoDialog').hide()" />
            </p:column>
            <p:ajax event="page" onstart="PF('statusInfoDialog').show()" oncomplete="PF('statusInfoDialog').hide()" />
        </p:dataTable>
    </p:fieldset>
</ui:composition>
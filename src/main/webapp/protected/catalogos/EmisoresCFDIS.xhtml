<ui:composition xmlns="http://www.w3.org/1999/xhtml"
xmlns:h="http://java.sun.com/jsf/html"
xmlns:f="http://java.sun.com/jsf/core"
xmlns:ui="http://java.sun.com/jsf/facelets"
xmlns:p="http://primefaces.org/ui" template="/WEB-INF/template.xhtml"
xmlns:jsf="http://xmlns.jcp.org/jsf">

<ui:define name="title">Emisores</ui:define>

	<style>
		body .ui-panelgrid .ui-panelgrid-cell {
		border: none !important;
		padding: 0px;
		}
		.ui-fluid .ui-password {
		width: 90% !important;
		display: inline-block !important;
		}
		body .ui-input-icon-right>i:last-of-type {
		right: 1rem;
		}
		body .ui-input-icon-right>.ui-inputfield {
		width: 100%;
		}
	</style>

<ui:define name="content">
<h:form id="form">
<p:breadCrumb>
<p:menuitem value="Home" outcome="/dashboard" />
<p:menuitem value="Emisores" />
<p:menuitem value="Emisores CFDIS" outcome="/protected/catalogos/EmisoresCFDIS" />
</p:breadCrumb>

<p:growl id="messages" showDetail="true" />
<p:toolbar styleClass="p-mb-4">
<p:toolbarGroup>
<p:commandButton value="Agregar" icon="pi pi-plus" actionListener="#{emisoresCFDISBean.newEmisor}" update="pnlEmisor" oncomplete="PF('dialogEmisor').show();" styleClass="ui-button-info p-mr-2 p-mb-2" style="margin-right: .5rem" process="@this" />
</p:toolbarGroup>
</p:toolbar>

<div class="p-grid crud-demo">
<div class="p-col-12">
<div class="card">

		<p:dataTable id="dt-emisor" lazy="true" widgetVar="dtEmisor" var="emisordt" value="#{emisoresCFDISBean.listaEmisor}" reflow="true" rowKey="#{emisordt.emisor}" paginator="true" rows="10" paginatorPosition="bottom" rowSelectMode="add">
			<p:column headerText="Nombre">
				<h:outputText value="#{emisordt.nb_emisor}" />
			</p:column>

		<p:column headerText="Tipo">
			<h:outputText value="#{emisordt.tp_persona}" />
		</p:column>
		
		<p:column headerText="RFC">
			<h:outputText value="#{emisordt.nb_rfc}" />
		</p:column>

		<p:column headerText="Inicio de operaciones">
			<h:outputText value="#{emisordt.nb_rfc}" />
		</p:column>
		
		<p:column headerText="Ult. Cambio">
			<h:outputText value="#{emisordt.fh_ult_cambio}" />
		</p:column>
		
		<p:column headerText="Status Padron">
			<h:outputText value="#{emisordt.st_padron}" />
		</p:column>

		<p:column headerText="AcciÃ³n" style="text-align:right">
				<p:commandButton icon="pi pi-pencil" update=":form:pnlEmisor" value="Modificar" oncomplete="PF('dialogEmisor').show();" styleClass="edit-button" process="@this">
					<f:setPropertyActionListener value="#{emisordt}" target="#{emisoresCFDISBean.emisor}" />
				</p:commandButton>
		</p:column>

		<p:column>
			<p:commandButton value="Archivos CSD" styleClass="ui-button-raised ui-button-secondary" oncomplete="PF('dialogCSD').show()" icon="pi pi-upload" process="@this">
				<f:setPropertyActionListener value="#{emisordt}" target="#{emisoresCFDISBean.emisor}" />
			</p:commandButton>
		</p:column>

</p:dataTable>

</div>
</div>
</div>

		<p:dialog header="Agregar emisor" showEffect="fade" modal="true" widgetVar="dialogEmisor" responsive="true">
		<p:outputPanel id="pnlEmisor" class="ui-fluid">

		<div class="p-grid">
					<div class="p-col-12 p-md-6 p-lg-4">
						<i class="pi pi-user" />
						<p:outputLabel for="@next" value="Nombre del emisor"/>
						<p:inputText value="#{emisoresCFDISBean.nombreEmisor}" required="true"/>
					</div>
					
					<div class= "p-col-12 p-md-6 p-lg-4">
					  <p:selectOneRadio id="tP" value="#{emisoresCFDISBean.tipoPersona}" layout="grid" columns="3" styleClass="grid-radio" >
					    <f:selectItem itemLabel="Persona Moral" itemValue="M"/>
           				<f:selectItem itemLabel="Persona Fisica" itemValue="F"/>
				        <p:ajax listener="#{emisoresCFDISBean.RegimenSelect}" process="@this" update="regimenFiscal"/>
				        </p:selectOneRadio>
				       <!--   <input id="regimenFiscal" type="text" disabled>-->
					</div>

					<div class="p-col-12 p-md-6 p-lg-4">
						<p:outputLabel for="@next" value="Regimen Capital" styleClass="ml-4" />
						<p:inputText value="#{emisoresCFDISBean.regimenCapital}"/>
					</div>
					
					<div class="p-col-12 p-md-6 p-lg-4">
						<p:outputLabel for="@next" value="RFC" styleClass="ml-4" />
						<p:inputText value="#{emisoresCFDISBean.rfc}" required="true" />
					</div>
					
					<div class="p-col-12 p-md-6 p-lg-4">
					<p:outputLabel for="regimenFiscal" value="Regimen Fiscal" />
					<p:selectOneMenu id="regimenFiscal" value="#{emisoresCFDISBean.regimenFiscal}" converter="entityConverter" >
                       <f:selectItem itemLabel="---Seleccione---" itemValue=""  />
                        <f:selectItems value="#{emisoresCFDISBean.listaRegimenFiscal}" var="regimenFiscal" itemLabel="#{regimenFiscal.nb_regimen}" itemValue="#{regimenFiscal.cd_regimen}" />
                        <p:ajax />
                    </p:selectOneMenu>
					</div>
					
					<div class="p-col-12 p-md-6 p-lg-4">
						<p:outputLabel for="@next" value="Inicio de operaciones" styleClass="ml-4"/>
						<p:datePicker value="#{emisoresCFDISBean.iniOperacion}" required="true"/>
					</div>
					<div class="p-col-12 p-md-6 p-lg-4">
						<p:outputLabel for="@next" value="Ulltimo cambio en el Sat" styleClass="ml-4"/>
						<p:datePicker value="#{emisoresCFDISBean.ultSAT}" required="true"/>
					</div>
					
					<div class="p-col-12 p-md-6 p-lg-4">
					<p:outputLabel for="statusPadron" value="Padron" />
					<p:selectOneMenu id="statusPadron" value="#{emisoresCFDISBean.padron}" converter="entityConverter" >
                       <f:selectItem itemLabel="---Seleccione---" itemValue=""  />
                        <f:selectItems value="#{emisoresCFDISBean.listaEmisor}" var="statusPadron" itemLabel="#{statusPadron.st_padron}" itemValue="#{statusPadron.st_padron}"/>
                        <p:ajax />
                        </p:selectOneMenu>
					</div>
				</div>
			</p:outputPanel>

			<f:facet name="footer">
			<p:commandButton value="Guardar" icon="pi pi-check" actionListener="#{emisoresCFDISBean.guardaEmisor}" />
			<p:commandButton value="Cancelar" icon="pi pi-times" class="ui-button-secondary" onclick="PF('dialogEmisor').hide()" />
			</f:facet>
</p:dialog>
<script type="text/javascript">
	function DisabledRF(){
		 var tipoPersona = document.getElementById("tP");
		 var  rF = document.getElementById("regimenFiscal");
		 tP.disable= tipoPersona.checked? false:true;
		 tP.value="";
		 if(!tP.disabled){
			 tP.focus();
		 }
	}
</script>
</h:form>
</ui:define>
</ui:composition>

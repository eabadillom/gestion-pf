<ui:composition xmlns="http://www.w3.org/1999/xhtml"
	xmlns:h="http://java.sun.com/jsf/html"
	xmlns:f="http://java.sun.com/jsf/core"
	xmlns:ui="http://java.sun.com/jsf/facelets"
	xmlns:p="http://primefaces.org/ui" template="/WEB-INF/template.xhtml">
	<ui:define name="title">Kardex</ui:define>

	<ui:define name="content">
		<h:form id="form">
			<p:breadCrumb>
				<p:menuitem value="Home" outcome="/dashboard" />
				<p:menuitem value="Inventarios" />
				<p:menuitem value="Kardex" outcome="/protected/catalogos/kardex" />
			</p:breadCrumb>

			<div class="p-grid kardex">
				<div class="p-col-12">
					<div class="card">
						<p:growl id="messages" showDetail="true" />
						<div class="p-col-12">
							<div class="card">
								<span class="ui-float-label"> <p:inputText
										id="folioSelected" value="#{kardexBean.folioClienteSelected}" />
									<p:outputLabel for="@previous" value="Folio"
										styleClass="ui-float-label p-mr-2 p-mb-2" /> <p:commandButton
										id="buscarFolio" actionListener="#{kardexBean.buscaDatos()}"
										icon="pi pi-search" process="@this folioSelected"
										styleClass="edit-button ui-button-primary" value="Buscar"
										update="form:dt-entradasKardex form:numeroCliente form:nombreCliente" />
										
										 <p:commandButton
										value="Limpiar" styleClass="edit-button ui-button-secondary" />
								</span>
							</div>
							

							<div class="card">
								<div class="p-d-inline-flex p-ai-center"
									style="vertical-align: middle">
									<h:outputText id="numeroCliente" styleClass="p-ml-2"
										value="#{kardexBean.clienteSelected.numeroCte}" />
									<h:outputText id="nombreCliente" styleClass="p-ml-2"
										value="#{kardexBean.clienteSelected.cteNombre}" />
										<p:commandButton value="Traspasos"
										styleClass="edit-button ui-botton-primary" process="@this"
										oncomplete="PF('traspasosDialog').show()"
										update="form:panel-traspasos" />
								</div>
							</div>
							<p:dataTable id="dt-entradasKardex" widgetVar="dtEntradasKardex"
								value="#{kardexBean.listPartida}" var="pPartidas"
								rowKey="#{pPartidas.partidaCve}" paginator="true" rows="10"
								paginatorPosition="bottom">
								
									
								<p:column style="width:2rem" width="5">
									<p:rowToggler />
								</p:column>

								<p:column headerText="Fecha de ingreso" width="40">
									<h:outputText
										value="#{kardexBean.constanciaDepositoSelected.fechaIngreso}" />
								</p:column>

								<p:column headerText="Entrada" width="40">
									<h:outputText
										value="#{kardexBean.constanciaDepositoSelected.folio}" />
								</p:column>

								<p:column headerText="Producto" width="120">
									<h:outputText
										value="#{pPartidas.unidadDeProductoCve.productoCve.productoDs}" />
								</p:column>

								<p:column headerText="Piezas Entrada" width="20">
									<h:outputText value="#{pPartidas.cantidadTotal}" />
								</p:column>

								<p:column headerText="Unidad" width="30">
									<h:outputText
										value="#{pPartidas.unidadDeProductoCve.unidadDeManejoCve.unidadDeManejoDs}" />
								</p:column>

								<p:column headerText="Kilos Entrada" width="30">
									<h:outputText value="#{pPartidas.pesoTotal}" />
								</p:column>

								<p:column headerText="Planta" width="30">
									<h:outputText value="#{pPartidas.camaraCve.plantaCve.plantaDs}" />
								</p:column>

								<p:column headerText="CÃ¡mara" width="50">
									<h:outputText value="#{pPartidas.camaraCve.camaraDs}" />
								</p:column>

								<p:rowExpansion>
									<div class="st-Salidas">
										<p:dataTable id="dt-salidasKardex"
											value="#{kardexBean.listDetalleSalida}" paginator="true"
											var="pSalidas" rows="5" paginatorPosition="bottom"
											rowKey="#{pSalidas.id}">
											<p:column headerText="Fecha" width="30">
												<h:outputText value="#{pSalidas.constanciaCve.fecha}" />
											</p:column>
											<p:column headerText="Salida" width="30">
												<h:outputText value="#{pSalidas.constanciaCve.numero}" />
											</p:column>
											<p:column headerText="Producto" width="150">
												<h:outputText value="#{pSalidas.producto}" />
											</p:column>
											<p:column headerText="Piezas Salida" width="30">
												<h:outputText value="#{pSalidas.cantidad}" />
											</p:column>
											<p:column headerText="Unidad" width="30">
												<h:outputText value="#{pSalidas.unidad}" />
											</p:column>
											<p:column headerText="Kilos Salida" width="30">
												<h:outputText value="#{pSalidas.peso}" />
											</p:column>
										</p:dataTable>
										<p:dataTable var="dt-totalesKardex"
											value="#{kardexBean.cantidadTotal}" paginator="false"
											rows="2">
											<p:column headerText="Totales">
												<h:outputText value="" />
											</p:column>
											<p:column headerText="Total piezas Entrada">
												<h:outputText value="#{pPartidas.cantidadTotal}" />
											</p:column>
											<p:column headerText="Total piezas Salida">
												<h:outputText value="#{kardexBean.obtenTotales().cantidad}" />
											</p:column>
											<p:column headerText="Saldo Piezas">
												<h:outputText value="#{pPartidas.cantidadTotal - kardexBean.obtenTotales().cantidad}" />
											</p:column>
											<p:column headerText="Total Kilos Entrada">
												<h:outputText value="#{pPartidas.pesoTotal}" />
											</p:column>
											<p:column headerText="Total Kilos Salida">
												<h:outputText value="#{kardexBean.obtenTotales().peso}" />
											</p:column>
											<p:column headerText="Saldo Kilos">
												<h:outputText value="#{pPartidas.pesoTotal - kardexBean.obtenTotales().peso}" />
											</p:column>
										</p:dataTable>
									</div>
								</p:rowExpansion>
							</p:dataTable>

							<p:dialog header="Traspasos" showEffect="fade" modal="true"
								widgetVar="traspasosDialog" responsive="true">
								<p:outputPanel id="panel-traspasos" class="ui-fluid">
									<p:dataTable id="dt-traspasos" widgetVar="dtTraspasos"
										var="pPartidas" value="#{dataTableDemoView.products1}"
										paginator="true" rows="10" paginatorPosition="bottom"
										rowKey="#{product.id}">
										<p:headerRow field="id">
											<p:column colspan="6">
												<div class="p-d-inline-flex p-ai-center"
													style="vertical-align: middle">
													<h:outputText styleClass="p-ml-2" value="Traspaso 001" />
													<h:outputText styleClass="p-ml-2" value="2022-06-29" />
												</div>
											</p:column>
										</p:headerRow>
										<p:column headerText="Descripcion">
											<h:outputText value="Producto1" />
										</p:column>
										<p:column headerText="Cantidad">
											<h:outputText value="2100" />
										</p:column>
										<p:column headerText="Unidad">
											<h:outputText value="Cajas" />
										</p:column>
										<p:column headerText="Origen">
											<h:outputText value="Refrigeracion1" />
										</p:column>
										<p:column headerText="Destino">
											<h:outputText value="Refrigeracion4" />
										</p:column>
									</p:dataTable>
								</p:outputPanel>
							</p:dialog>

						</div>
					</div>
				</div>

			</div>
		</h:form>
	</ui:define>
</ui:composition>
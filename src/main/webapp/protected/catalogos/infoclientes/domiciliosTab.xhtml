<ui:composition 
    xmlns="http://www.w3.org/1999/xhtml"
    xmlns:h="http://xmlns.jcp.org/jsf/html"
    xmlns:f="http://java.sun.com/jsf/core"
    xmlns:p="http://primefaces.org/ui"
    xmlns:ui="http://xmlns.jcp.org/jsf/facelets">
    <p:tab title="Domicilios">
        <div class="p-field p-col">
            <p:outputLabel for="soClienteTipoDom" value="Tipo de domicilio" />
            <p:selectOneMenu id="soClienteTipoDom" converter="entityConverter"
                    disabled="#{clientesBean.clienteSelected eq null and clientesBean.clienteSelected.cteCve eq null}"
                    value="#{clientesBean.tipoDomicilioSelected}" requiredMessage="Campo requerido" >
                    <f:selectItem itemLabel="--Selecciona--" itemValue="#{null}"/>
                    <f:selectItems value="#{clientesBean.lstTiposDomicilio}" var="tipoDomicilio"
                            itemLabel="#{tipoDomicilio.domicilioTipoDesc}" itemValue="#{tipoDomicilio}" />
                    <p:ajax listener="#{clientesBean.filtraListadoDomicilioFiltered()}" event="valueChange" 
                            update="form:tabView:btnAddClienteDireccion form:tabView:dt-domiciliosCliente"/>
            </p:selectOneMenu>
        </div>
        <div class="p-field p-col-3 p-md-6">
            <span class="filter-container ui-input-icon-left"> <p:commandButton
                    id="btnAddClienteDireccion" icon="pi pi-plus" value="Agregar" process="@this"
                    update="form:panel-addClienteDireccion"
                    styleClass="ui-button-primary" style="margin-right: .5rem"
                    actionListener="#{clientesBean.limpiaClienteDomicilio()}"
                    oncomplete="PF('clienteDireccionesAddDialog').show()"
                    disabled="#{clientesBean.clienteSelected eq null or clientesBean.tipoDomicilioSelected eq null}"
                    resetValues="panel-addClienteDireccion" />
            </span>
        </div>
        <p:dataTable id="dt-domiciliosCliente"
            widgetVar="dtDomiciliosCliente"
            value="#{clientesBean.lstClienteDomiciliosFiltered}"
            var="pClienteDomicilios"
            rowKey="#{pClienteDomicilios.domicilios.domCve}"
            selection="#{clientesBean.clienteDomicilioSelected}"
            reflow="true" lazy="false" paginator="true" rows="10"
            selectionMode="single" rowSelectMode="add"
            paginatorPosition="bottom" >
            <f:facet name="header">
                <div class="domiciliosCliente-table-header">
                        <span style="font-weight: bold">Domicilios del cliente</span>
                </div>
            </f:facet>
            <p:column headerText="Estado">
                <h:outputText
                    value="#{pClienteDomicilios.domicilios.asentamiento.asentamientoHumanoPK.ciudades.ciudadesPK.municipios.municipiosPK.estados.estadoDesc}" />
            </p:column>
            <p:column headerText="Municipio">
                <h:outputText
                    value="#{pClienteDomicilios.domicilios.asentamiento.asentamientoHumanoPK.ciudades.ciudadesPK.municipios.municipioDs}" />
            </p:column>
            <p:column headerText="Ciudad">
                <h:outputText
                    value="#{pClienteDomicilios.domicilios.asentamiento.asentamientoHumanoPK.ciudades.ciudadDs}" />
            </p:column>
            <p:column headerText="CP">
                <h:outputText
                    value="#{pClienteDomicilios.domicilios.asentamiento.cp}" />
            </p:column>
            <p:column headerText="Calle">
                <h:outputText
                    value="#{pClienteDomicilios.domicilios.domicilioCalle}" />
            </p:column>
            <p:column headerText="Núm. Ext.">
                <h:outputText
                    value="#{pClienteDomicilios.domicilios.domicilioNumExt}" />
            </p:column>
            <p:column headerText="Núm. Int.">
                <h:outputText
                    value="#{pClienteDomicilios.domicilios.domicilioNumInt}" />
            </p:column>
            <p:column headerText="Tipo Domicilio">
                <h:outputText
                    value="#{pClienteDomicilios.domicilios.domicilioTipoCve.domicilioTipoDesc}" />
            </p:column>
            <p:column>
                <p:commandButton icon="pi pi-pencil" process="@this"
                    styleClass="edit-button ui-button-primary"
                    oncomplete="PF('clienteDireccionesActDialog').show()"
                    update="form:panel-actClienteDireccion" action="#{clientesBean.cargaInfoDomicilio()}" >
                    <f:setPropertyActionListener value="#{pClienteDomicilios}"
                        target="#{clientesBean.clienteDomicilioSelected}" />
                </p:commandButton>
                <p:commandButton class="ui-button-danger" icon="pi pi-trash"
                    process="@this"
                    oncomplete="PF('deleteClienteDireccionesDialog').show()">
                    <f:setPropertyActionListener value="#{pClienteDomicilios}"
                        target="#{clientesBean.clienteDomicilioSelected}" />
                </p:commandButton>
            </p:column>
        </p:dataTable>
    </p:tab>                
</ui:composition>
